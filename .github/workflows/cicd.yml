name: CI
on:
  push:
    branches: [ "main", "analyze"]
  pull_request:
    branches: [ "main", "analyze" ]
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: install packages
        run: make install
      - name: lint
        run: make lint
      - name: test
        run: make test
      - name: format
        run: make format
      
      - name: Generate Badges
        id: generate_badges
        run: |
          echo "::set-output name=INSTALL_BADGE::https://img.shields.io/badge/Install-Success-green.svg"
          echo "::set-output name=LINT_BADGE::https://img.shields.io/badge/Lint-Success-green.svg"
          echo "::set-output name=TEST_BADGE::https://img.shields.io/badge/Test-Success-green.svg"
          echo "::set-output name=FORMAT_BADGE::https://img.shields.io/badge/Format-Success-green.svg"

      - name: Output Badges
        run: |
          echo "Install Badge: ${{ steps.generate_badges.outputs.INSTALL_BADGE }}"
          echo "Lint Badge: ${{ steps.generate_badges.outputs.LINT_BADGE }}"
          echo "Test Badge: ${{ steps.generate_badges.outputs.TEST_BADGE }}"
          echo "Format Badge: ${{ steps.generate_badges.outputs.FORMAT_BADGE }}"